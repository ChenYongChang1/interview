WebSocket
===

## 基础
由于 http 存在一个明显的弊端（消息只能有客户端推送到服务器端，而服务器端不能主动推送到客户端），导致如果服务器如果有连续的变化，这时只能使用轮询，而轮询效率过低，并不适合。于是 WebSocket 被发明出来。

* 支持双向通信，实时性更强；
* 可以发送文本，也可以二进制文件；
* 协议标识符是 ws，加密后是 wss ；
* 较少的控制开销。连接创建后，ws客户端、服务端进行数据交换时，协议控制的数据包头部较小。在不包含头部的情况下，服务端到客户端的包头只有2~10字节（取决于数据包长度），客户端到服务端的的话，需要加上额外的4字节的掩码。而HTTP协议每次通信都需要携带完整的头部；
* 支持扩展。ws协议定义了扩展，用户可以扩展协议，或者实现自定义的子协议。（比如支持自定义压缩算法等）
* 无跨域问题。

## 为什么websocket可以跨域

websocket的请求报文中，有一个字段是Origin，表示该请求的请求源（origin），即发自哪个域名。是因为有了Origin这个字段，所以浏览器没有对websocket执行同源策略显示，因为服务器可以根据这个字段，判断是否许可本次通信。

那么，如何保证websocket的安全性呢？

作为一项新技术，WebSockets旨在从一开始就支持跨域场景。任何编写服务器逻辑的人都应该意识到跨域请求的可能性，并执行必要的验证，而无需使用浏览器端强大的同源策略。